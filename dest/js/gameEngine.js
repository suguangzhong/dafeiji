"use strict";var gameEngine={ele:null,allBullets:[],allEnemys:[],totalScore:0,init:function(){return this.ele=document.getElementById("main"),this},start:function(){console.log("游戏开始"),this.loading(function(){myPlane.init().move(),myPlane.fire(),gameEngine.listenKeyword(),gameEngine.createEnemy(),gameEngine.backgroundMove(),gameEngine.crash()})},loading:function(e){var n=document.createElement("div");gameEngine.ele.appendChild(n),n.className="logo";var t=document.createElement("div");gameEngine.ele.appendChild(t),t.className="load";var l=["../images/loading1.png","../images/loading2.png","../images/loading3.png"],a=0,o=setInterval(function(){a>=5?(clearInterval(o),gameEngine.ele.removeChild(n),gameEngine.ele.removeChild(t),e&&e()):t.style.backgroundImage="url("+l[++a%3]+")"},500)},listenKeyword:function(){var e=0,n=0;window.onkeydown=function(t){37==(t=t||event).keyCode&&(e=-10),38==t.keyCode&&(n=-10),39==t.keyCode&&(e=10),40==t.keyCode&&(n=10)},window.onkeyup=function(t){37==(t=t||event).keyCode||39==t.keyCode?e=0:38!=t.keyCode&&40!=t.keyCode||(n=0)},setInterval(function(){var t=myPlane.ele.offsetLeft+e;t<0&&(t=0),t>gameEngine.ele.offsetWidth-myPlane.ele.offsetWidth&&(t=gameEngine.ele.offsetWidth-myPlane.ele.offsetWidth);var l=myPlane.ele.offsetTop+n;l<0&&(l=0),l>gameEngine.ele.clientHeight-myPlane.ele.offsetHeight&&(l=gameEngine.ele.clientHeight-myPlane.ele.offsetHeight),myPlane.ele.style.left=t+"px",myPlane.ele.style.top=l+"px"},30)},createEnemy:function(){setInterval(function(){Math.random()>.6&&new Enemy(Enemy.prototype.Enemy_Type_Large).init().move()},6e3),setInterval(function(){Math.random()>.5&&new Enemy(Enemy.prototype.Enemy_Type_Middle).init().move()},2e3),setInterval(function(){Math.random()>.4&&new Enemy(Enemy.prototype.Enemy_Type_Small).init().move()},1e3)},backgroundMove:function(){var e=0;setInterval(function(){gameEngine.ele.style.backgroundPositionY=e+++"px"},30)},crash:function(){var e=setInterval(function(){for(var n=0;n<gameEngine.allEnemys.length;n++){for(var t=0;t<gameEngine.allBullets.length;t++)isCrash(gameEngine.allBullets[t].ele,gameEngine.allEnemys[n].ele)&&(gameEngine.allBullets[t].boom(),gameEngine.allBullets.splice(t,1),gameEngine.allEnemys[n].hurt());isCrash(gameEngine.allEnemys[n].ele,myPlane.ele)&&(clearInterval(e),myPlane.boom(function(){var e=prompt("请输入您的名字,您的分数为:"+gameEngine.totalScore,"老王吧");ajax({type:"post",url:"http://60.205.181.47/myPHPCode4/uploadScore.php",data:{name:e,score:gameEngine.totalScore},success:function(e){location.href="../html/02_rand.html"}})}))}},30)}};